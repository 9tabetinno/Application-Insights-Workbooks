{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{mappedSubscription}"
        ],
        "parameters": [
          {
            "id": "67dcb2cb-14b1-4d77-b52b-f728abbf43a2",
            "version": "KqlParameterItem/1.0",
            "name": "mappedTenantId",
            "type": 1,
            "isGlobal": true,
            "query": "resources\r\n| take 1\r\n| project tenantId",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "7a2bb320-fa9c-45c8-bbf6-942c8b3a4b0e",
            "version": "KqlParameterItem/1.0",
            "name": "mappedSubscription",
            "label": "subscription",
            "type": 6,
            "isGlobal": true,
            "value": "community-workbooks/UpdateCompliance/Update Compliance Hub",
            "typeSettings": {
              "additionalResourceOptions": [],
              "includeAll": true,
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "01c6d66e-3f87-4e8a-8be6-0accbe4f4036",
            "version": "KqlParameterItem/1.0",
            "name": "mappedWorkspace",
            "label": "workspace",
            "type": 5,
            "isRequired": true,
            "isGlobal": true,
            "query": "resources\r\n| where type == \"microsoft.operationalinsights/workspaces\"\r\n| where \"{mappedSubscription:subscriptionId}\" == subscriptionId\r\n//| project name",
            "crossComponentResources": [
              "{mappedSubscription}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "3b134915-f09f-417c-9da3-532eaff1a593",
            "version": "KqlParameterItem/1.0",
            "name": "hasLogAnalyticsData",
            "type": 1,
            "isGlobal": true,
            "value": "true",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "2776722c-672e-4a35-9c4b-3d8e74c1083f",
            "version": "KqlParameterItem/1.0",
            "name": "_SnapshotTime",
            "type": 1,
            "description": "Time indicating the latest snapshot",
            "isRequired": true,
            "isGlobal": true,
            "query": "UCClient\r\n| where TimeGenerated >= ago(7d)\r\n| summarize max(TimeGenerated)",
            "isHiddenWhenLocked": true,
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "ecc5543b-8b44-4d30-bc9c-3bbace67fec6",
            "version": "KqlParameterItem/1.0",
            "name": "useSubscribeAPI",
            "type": 1,
            "description": "Whether or not to show certain components based on if the subscribe api is ready to be used in workbooks",
            "isGlobal": true,
            "value": "false",
            "isHiddenWhenLocked": true,
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "name": "parameters - 2"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<img src=\"https://admin.microsoft.com/images/EmptyState/EmptyState_illustration_admin-action_group-of-cards-with-pencil_200px.png\"\nstyle=\"display: block;width:30%;margin-left:auto;margin-right:auto;\">\n</img>\n<br></br>\n\n<h2 markdown=\"1\" style=\"display:block;text-align:center;margin-left:auto;margin-right:auto;\">\nWelcome to Update Compliance\n</h2>\n\n<p markdown=\"1\" style=\"display:block;width:45%;text-align:center;margin-left:auto;margin-right:auto;\">\nGet started with Update Compliance and begin monitoring your Windows updates. A policy, Azure AD and a Log Anaytics workspace are required. <a href=\"https://go.microsoft.com/fwlink/p/?linkid=2196482\" target='_blank'>Learn More</a>.\n</p>"
            },
            "name": "text - 2",
            "styleSettings": {
              "margin": "0",
              "padding": "50"
            }
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "990a0852-8517-47ec-91c2-d8a3bb7e1134",
                  "cellValue": "community-workbooks/UpdateCompliance/Update Compliance Hub",
                  "linkTarget": "WorkbookTemplate",
                  "linkLabel": "Get Started",
                  "style": "primary",
                  "workbookContext": {
                    "componentIdSource": "workbook",
                    "resourceIdsSource": "default",
                    "templateIdSource": "static",
                    "templateId": "community-workbooks/UpdateCompliance/Quality Updates/resourceGroups/EdpTest2/providers/microsoft.insights/workbooks/b69c701a-2759-40ad-9dca-cab0e024a1d5",
                    "typeSource": "default",
                    "gallerySource": "default",
                    "locationSource": "default"
                  }
                }
              ]
            },
            "conditionalVisibility": {
              "parameterName": "useSusbcribeAPI",
              "comparison": "isEqualTo",
              "value": "true"
            },
            "name": "links - 2",
            "styleSettings": {
              "padding": "0px 0px 0px 0px"
            }
          },
          {
            "type": 1,
            "content": {
              "json": "<p markdown=\"1\" style=\"display:block;width:45%;text-align:center;margin-left:auto;margin-right:auto;\">\r\nTo create a Log Analytics workspace, <a href=\"\" target='_blank'>click here</a>.\r\n</p>"
            },
            "conditionalVisibility": {
              "parameterName": "useSubscribeAPI",
              "comparison": "isEqualTo",
              "value": "false"
            },
            "name": "text - 2"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibility": {
        "parameterName": "mappedWorkspace",
        "comparison": "isEqualTo"
      },
      "customWidth": "100",
      "name": "PreonboardingGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<img src=\"https://prod.msocdn.com/M365/admin-main/2022.6.9.5/45d61a60d22c9f6dfce067f9991d8c0b.svg\"\r\nstyle=\"display: block;width:30%;margin-left:auto;margin-right:auto;\">\r\n</img>\r\n<br></br>\r\n\r\n<h2 markdown=\"1\" style=\"display:block;text-align:center;margin-left:auto;margin-right:auto;\">\r\nWaiting for Update Compliance data\r\n</h2>\r\n\r\n<p markdown=\"1\" style=\"display:block;width:45%;text-align:center;margin-left:auto;margin-right:auto;\">\r\nYou’ve enrolled in Update Compliance, but we’re still processing your data as a first-time setup. This will typically take 24 hours. Check back soon!\r\n</p>"
            },
            "name": "text - 0"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibilities": [
        {
          "parameterName": "mappedWorkspace",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "hasLogAnalyticsData",
          "comparison": "isNotEqualTo",
          "value": "true"
        }
      ],
      "name": "WaitingForDataGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "loadType": "always",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "**Subscription**: {mappedSubscription:name} &nbsp;&nbsp; **Workspace**: {mappedWorkspace:name} &nbsp;&nbsp; <a href='https://ms.portal.azure.com/#blade/AppInsightsExtension/UsageNotebookBlade/ComponentId/%2Fsubscriptions%2F15820d8b-8b26-4182-8db6-7bd2be4491f6%2Fresourcegroups%2Fedptest2%2Fproviders%2Fmicrosoft.operationalinsights%2Fworkspaces%2Foms-uc-test/ConfigurationId/%2Fsubscriptions%2F15820d8b-8b26-4182-8db6-7bd2be4491f6%2Fresourcegroups%2Fedptest2%2Fproviders%2Fmicrosoft.insights%2Fworkbooks%2Fb69c701a-2759-40ad-9dca-cab0e024a1d5/Type/workbook/WorkbookTemplateName/Get%20started%20with%20Update%20Compliance'>Change the subscription or workspace</a>"
            },
            "name": "Sub_WS Information"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "tabs",
              "links": [
                {
                  "id": "b3f4c34c-d421-4373-a567-8e3b10e63235",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Summary",
                  "subTarget": "Summary",
                  "style": "link"
                },
                {
                  "id": "a55effea-5f5f-45c2-89ea-8032affc3541",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Quality Updates",
                  "subTarget": "QualityUpdates",
                  "style": "link"
                },
                {
                  "id": "4fa51e7a-596b-43fe-9137-f03b488224f1",
                  "cellValue": "currentWorkbook",
                  "linkTarget": "parameter",
                  "linkLabel": "Feature Updates",
                  "subTarget": "FeatureUpdates",
                  "style": "link"
                }
              ]
            },
            "name": "WorkbookTabControl"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let SnapshotTime = datetime({_SnapshotTime});\r\nUCClient\r\n| where TimeGenerated == SnapshotTime\r\n| extend Title = \"Total\"\r\n| extend SeeDeviceDistribution = \"See device distribution\"\r\n| summarize TotalDevices=count() by SeeDeviceDistribution, Title\r\n",
                    "size": 4,
                    "title": "Enrolled devices",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "subtitleContent": {
                        "columnMatch": "Title",
                        "formatter": 1
                      },
                      "rightContent": {
                        "columnMatch": "TotalDevices",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "SeeDeviceDistribution",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "WorkbookTemplate",
                          "bladeOpenContext": {
                            "bladeParameters": []
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "20",
                  "name": "TotalEnrolledDevices"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nlet DeviceAlert = UCDeviceAlert\r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\";\r\nlet UpdateAlert = UCUpdateAlert\r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\";\r\nDeviceAlert\r\n| union (UpdateAlert)\r\n| extend Title = \"Errors\"\r\n| extend ViewDetail = \"View detail\"\r\n| summarize ActiveAlerts = count() by Title, ViewDetail",
                    "size": 4,
                    "title": "Active alerts",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "subtitleContent": {
                        "columnMatch": "Title",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "ActiveAlerts",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "3",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "ActiveAlerts",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "ViewDetail",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "WorkbookTemplate"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "20",
                  "name": "ActiveAlerts"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "UCClientReadinessStatus\r\n| summarize Capable = countif(ReadinessStatus == \"Capable\"), Total = count(), Title = \"Capable\", ViewDetail = \"View detail\"\r\n| extend CapableCount = (Capable * 1.0 / Total) * 100",
                    "size": 4,
                    "title": "Windows 11 elibigility",
                    "timeContext": {
                      "durationMs": 604800000
                    },
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {},
                      "subtitleContent": {
                        "columnMatch": "Title",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "ActiveAlerts",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "success",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "CapableCount",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "ViewDetail",
                        "formatter": 7,
                        "formatOptions": {
                          "linkTarget": "WorkbookTemplate"
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "20",
                  "name": "Win11Eligibility"
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "name": "spacer text"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "UCClientUpdateStatus\r\n| join kind=innerunique UCClient on AzureADDeviceId\r\n| where UpdateCategory == \"WindowsQualityUpdate\"\r\n//| summarize arg_max(TimeGenerated, *) by AzureADDeviceId\r\n| summarize SecurityUpdateStatus = count() by OSSecurityUpdateStatus\r\n",
                    "size": 3,
                    "title": "Overall security update status",
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{mappedWorkspace}"
                    ],
                    "visualization": "piechart",
                    "chartSettings": {
                      "yAxis": [
                        "SecurityUpdateStatus"
                      ],
                      "seriesLabelSettings": [
                        {
                          "seriesName": "Latest",
                          "color": "blue"
                        },
                        {
                          "seriesName": "NotLatest",
                          "label": "Not Latest",
                          "color": "orange"
                        },
                        {
                          "seriesName": "MultipleSecurityUpdatesMissing",
                          "label": "Multiple Security Updates Missing",
                          "color": "red"
                        }
                      ]
                    }
                  },
                  "name": "OverallSecurityUpdateStatusChart"
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "paragraph",
                    "links": [
                      {
                        "id": "f3d59e76-ffb9-42a8-b912-b034e54167a4",
                        "linkTarget": "WorkbookTemplate",
                        "linkLabel": "View more details in quality updates",
                        "style": "link",
                        "workbookContext": {
                          "componentIdSource": "workbook",
                          "resourceIdsSource": "workbook",
                          "templateIdSource": "static",
                          "templateId": "community-workbooks/UpdateCompliance/Quality Updates",
                          "typeSource": "workbook",
                          "gallerySource": "workbook",
                          "locationSource": "default"
                        }
                      }
                    ]
                  },
                  "name": "GoToQUChartLink",
                  "styleSettings": {
                    "margin": "0px 0px 0px 12px"
                  }
                }
              ],
              "exportParameters": true
            },
            "conditionalVisibility": {
              "parameterName": "currentWorkbook",
              "comparison": "isEqualTo",
              "value": "Summary"
            },
            "name": "SummaryContentGroup",
            "styleSettings": {
              "margin": "0",
              "padding": "0"
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "loadType": "always",
              "items": [
                {
                  "type": 9,
                  "content": {
                    "version": "KqlParameterItem/1.0",
                    "parameters": [
                      {
                        "id": "03761a72-d969-426b-ba54-d1e709610b2d",
                        "version": "KqlParameterItem/1.0",
                        "name": "_WorkbookContext",
                        "label": "Workbook Context",
                        "type": 1,
                        "description": "Whether workbook is opened standalone or as part of the Hub.",
                        "isRequired": true,
                        "query": "print(\"Focused\")",
                        "isHiddenWhenLocked": true,
                        "timeContext": {
                          "durationMs": 86400000
                        },
                        "queryType": 0,
                        "resourceType": "microsoft.operationalinsights/workspaces"
                      }
                    ],
                    "style": "above",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces"
                  },
                  "name": "parameters - 4"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "## Update Compliance: Quality Updates\n\n\nWelcome to Quality Update! Quality updates deliver both security and non-security fixes.Quality updates are cumulative, so installing the latest quality update is sufficient to get all the available fixes for a specific feature update, including any out-of-band security fixes and any servicing stack updates that might have been released previously. "
                  },
                  "name": "IntroQualityUpdate"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" and UpdateClassification == \"Security\"\r\n| extend DevicesTakingSecurityUpdate = \"Devices Taking Security Update\"\r\n| extend DevicesCount = \"Devices Count\"\r\n| summarize arg_max(TimeGenerated, *) by AzureADDeviceId\r\n| summarize TotalDevices=count() by DevicesTakingSecurityUpdate, DevicesCount\r\n",
                    "size": 3,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "TotalDevices",
                          "formatter": 0,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "DevicesCount"
                      },
                      "subtitleContent": {
                        "columnMatch": "DevicesTakingSecurityUpdate"
                      },
                      "rightContent": {
                        "columnMatch": "TotalDevices",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "0",
                  "name": "Devices Count",
                  "styleSettings": {
                    "margin": "10px 10px",
                    "padding": "0px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| join kind=innerunique UCClient on AzureADDeviceId\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" and OSSecurityUpdateStatus == \"Latest\" \r\n| extend Compliant = \"Compliant\"\r\n| extend Title = \"Latest Security Update\"\r\n| summarize arg_max(TimeGenerated, *) by AzureADDeviceId\r\n| summarize count() by OSSecurityUpdateStatus, Compliant, Title\r\n",
                    "size": 3,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "gridSettings": {
                      "sortBy": [
                        {
                          "itemKey": "LatestComplianceStatus",
                          "sortOrder": 1
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "LatestComplianceStatus",
                        "sortOrder": 1
                      }
                    ],
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title"
                      },
                      "subtitleContent": {
                        "columnMatch": "Compliant",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "OSSecurityUpdateStatus",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "success",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "count_",
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "0",
                  "name": "LatestSecurityUpdate",
                  "styleSettings": {
                    "margin": "10px 10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| join kind=innerunique UCClient on AzureADDeviceId\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" and OSSecurityUpdateStatus == \"MultipleSecurityUpdatesMissing\" \r\n| extend Title = \"Security Update Status\"\r\n| summarize arg_max(UpdateReleaseTime, *) by AzureADDeviceId\r\n| summarize SecurityUpdateStatus=count() by OSSecurityUpdateStatus, Title\r\n//| top 1 by SecurityUpdateStatus\r\n\r\n",
                    "size": 3,
                    "noDataMessageStyle": 5,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SecurityUpdateStatus",
                          "formatter": 0,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title",
                        "formatter": 1
                      },
                      "subtitleContent": {
                        "columnMatch": "OSSecurityUpdateStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "SecurityUpdateStatus",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "4",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "SecurityUpdateStatus",
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "0",
                  "name": "SecurityUpdateStatus",
                  "styleSettings": {
                    "margin": "10px 10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCUpdateAlert\r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\" and UpdateCategory==\"WindowsQualityUpdate\"\r\n| where isnotempty(TargetBuild) and TargetBuild != \"10.0.0.0\"\r\n| extend Title=\"Total Alerts\"\r\n| summarize count() by AlertStatus, Title",
                    "size": 3,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "TotalAlerts",
                          "formatter": 0,
                          "numberFormat": {
                            "unit": 17,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        }
                      ]
                    },
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title"
                      },
                      "subtitleContent": {
                        "columnMatch": "AlertStatus",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "TotalAlerts",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "3",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "count_",
                        "numberFormat": {
                          "unit": 17,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 2
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "0",
                  "name": "TotalAlerts",
                  "styleSettings": {
                    "margin": "10px 10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nWUDOAggregatedStatus\r\n//| where TimeGenerated == _SnapshotTime \r\n| extend BW_SAV_Percentage = BWOptPercent28Days \r\n| where ContentType  == \"Quality Updates\"\r\n| extend BWSAV = \"BW SAV(%)\"\r\n| extend Title=\"Delivery Optimization\"\r\n| summarize by BW_SAV_Percentage, BWSAV, Title\r\n| take 1\r\n",
                    "size": 3,
                    "timeContext": {
                      "durationMs": 86400000
                    },
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Title"
                      },
                      "subtitleContent": {
                        "columnMatch": "BWSAV"
                      },
                      "leftContent": {
                        "columnMatch": "BW_SAV_Percentage",
                        "formatter": 18,
                        "formatOptions": {
                          "thresholdsOptions": "icons",
                          "thresholdsGrid": [
                            {
                              "operator": "Default",
                              "thresholdValue": null,
                              "representation": "success",
                              "text": ""
                            }
                          ]
                        }
                      },
                      "rightContent": {
                        "columnMatch": "BW_SAV_Percentage",
                        "formatter": 1,
                        "numberFormat": {
                          "unit": 1,
                          "options": {
                            "style": "decimal"
                          }
                        }
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "0",
                  "name": "Delivery Optimization",
                  "styleSettings": {
                    "margin": "10px 10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 11,
                  "content": {
                    "version": "LinkItem/1.0",
                    "style": "tabs",
                    "links": [
                      {
                        "id": "45ff6d41-655d-48b7-9887-aab0dbe5b78c",
                        "cellValue": "selTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Update Status",
                        "subTarget": "UpdateStatus",
                        "style": "link"
                      },
                      {
                        "id": "ebf24b8e-0a03-415d-9018-3bdd02138627",
                        "cellValue": "selTab",
                        "linkTarget": "parameter",
                        "linkLabel": "Device Status",
                        "subTarget": "DeviceStatus",
                        "style": "link"
                      }
                    ]
                  },
                  "name": "links - 3"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\"\r\n| summarize count() by ClientState",
                          "size": 3,
                          "title": "Update states for all security releases",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Cancelling",
                                "label": "Unknown"
                              },
                              {
                                "seriesName": "",
                                "label": "Unknown"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumFractionDigits": 1
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "UpdateStatesAllSecurityReleases"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| join kind=innerunique UCClient on AzureADDeviceId\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" and UpdateClassification== \"Security\"\r\n| summarize arg_max(UpdateReleaseTime, *) by AzureADDeviceId\r\n| summarize count() by ClientState",
                          "size": 3,
                          "title": "Update states for latest security releases",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "piechart",
                          "chartSettings": {
                            "yAxis": [
                              "count_"
                            ],
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Cancelling",
                                "label": "Unknown"
                              },
                              {
                                "seriesName": "",
                                "label": "Unknown"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumFractionDigits": 1
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "showPin": false,
                        "name": "UpdateStatesLatestSecurityReleases"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCUpdateAlert \r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\" and UpdateCategory==\"WindowsQualityUpdate\"\r\n| where isnotempty(TargetBuild) and TargetBuild != \"10.0.0.0\"\r\n| summarize count() by AlertClassification\r\n",
                          "size": 3,
                          "title": "Update for all security releases",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "Cancelling",
                                "label": "Unknown"
                              },
                              {
                                "seriesName": "",
                                "label": "Unknown"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumFractionDigits": 1
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "Alerts(UpdateIssues)"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "### Update Deployment Status"
                        },
                        "name": "UpdateDeploymentStatusText",
                        "styleSettings": {
                          "margin": "0px 0px -20px 0px"
                        }
                      },
                      {
                        "type": 9,
                        "content": {
                          "version": "KqlParameterItem/1.0",
                          "parameters": [
                            {
                              "id": "5cd36655-0307-49d5-9b09-3e7a37514a9f",
                              "version": "KqlParameterItem/1.0",
                              "name": "_TargetVersion",
                              "label": "Target Version",
                              "type": 2,
                              "description": "Displays the target versions selected",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "UCClientUpdateStatus\r\n| where TimeGenerated >= datetime({_SnapshotTime})\r\n| where UpdateCategory == \"WindowsQualityUpdate\"\r\n| summarize by TargetVersion",
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "ALL",
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            },
                            {
                              "id": "f4cceee2-5a06-4535-b220-543f818f0b3f",
                              "version": "KqlParameterItem/1.0",
                              "name": "_UpdateClassification",
                              "label": "Update Classification",
                              "type": 2,
                              "description": "Show the Update Classification selected",
                              "isRequired": true,
                              "multiSelect": true,
                              "quote": "'",
                              "delimiter": ",",
                              "query": "\r\nlet _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated >= _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\"\r\n| summarize by UpdateClassification",
                              "value": [
                                "value::all"
                              ],
                              "typeSettings": {
                                "additionalResourceOptions": [
                                  "value::all"
                                ],
                                "selectAllValue": "ALL",
                                "showDefault": false
                              },
                              "defaultValue": "value::all",
                              "queryType": 0,
                              "resourceType": "microsoft.operationalinsights/workspaces"
                            }
                          ],
                          "style": "pills",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces"
                        },
                        "name": "Filters"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nlet KBLink = \"https://support.microsoft.com/help/\";\r\nlet _TargetVersion =\"{_TargetVersion}\";\r\nlet _UpdateClassification =\"{_UpdateClassification}\";\r\nlet DevicesInfo = (UCClientUpdateStatus \r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\" \r\n| where iff(_TargetVersion has \"ALL\", true, _TargetVersion has tostring(TargetVersion))\r\n| where iff(_UpdateClassification has \"ALL\", true, _UpdateClassification has tostring(UpdateClassification))\r\n| summarize \r\n    TotalDevices=count(),\r\n    InstalledCount=dcountif(AzureADDeviceId, ClientState == \"Installed\") by TargetVersion, TargetBuild, DeploymentId, TargetKBNumber, UpdateReleaseTime\r\n| extend TotalProgress=round((InstalledCount * 1.0/ TotalDevices) * 100, 1));\r\nlet Alerts = (UCUpdateAlert\r\n| where TimeGenerated == _SnapshotTime\r\n| where AlertStatus == \"Active\" and UpdateCategory==\"WindowsQualityUpdate\"\r\n| summarize Alerts=count() by TargetBuild);\r\nDevicesInfo\r\n| join kind=leftouter (Alerts) on TargetBuild\r\n| extend KBNumberLink = substring(TargetKBNumber, 2,8)\r\n| extend KBLinkText = iff(isnotempty(TargetKBNumber),strcat(KBLink, KBNumberLink), \"\")\r\n| extend ReleasedOn = format_datetime(UpdateReleaseTime, 'yyyy-M-dd')\r\n| summarize by TargetVersion, TargetBuild, ReleasedOn, UpdateReleaseTime, TotalProgress, Alerts, TotalDevices, DeploymentId, KBNumberLink, KBLinkText\r\n| project-reorder TargetVersion, TargetBuild, ReleasedOn, TotalProgress, Alerts, DeploymentId, KBNumberLink, KBLinkText, TotalDevices\r\n//| summarize sum(Alerts), sum(TotalDevices)\r\n\r\n",
                          "size": 2,
                          "showAnalytics": true,
                          "exportedParameters": [
                            {
                              "fieldName": "TotalDevices",
                              "parameterName": "_SelectedDevices"
                            },
                            {
                              "fieldName": "TargetVersion",
                              "parameterName": "_SelectedTargetVersion",
                              "parameterType": 1
                            },
                            {
                              "fieldName": "TargetBuild",
                              "parameterName": "_SelectedTargetBuild",
                              "parameterType": 1
                            }
                          ],
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "table",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "TargetVersion",
                                "formatter": 0,
                                "formatOptions": {
                                  "aggregation": "Count"
                                }
                              },
                              {
                                "columnMatch": "TotalProgress",
                                "formatter": 4,
                                "formatOptions": {
                                  "palette": "blue",
                                  "customColumnWidthSetting": "150px"
                                },
                                "numberFormat": {
                                  "unit": 1,
                                  "options": {
                                    "style": "decimal"
                                  }
                                }
                              },
                              {
                                "columnMatch": "Alerts",
                                "formatter": 18,
                                "formatOptions": {
                                  "linkTarget": "WorkbookTemplate",
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": ">",
                                      "thresholdValue": "50",
                                      "representation": "3",
                                      "text": "{0}{1}"
                                    },
                                    {
                                      "operator": "is Empty",
                                      "thresholdValue": "",
                                      "representation": "Blank",
                                      "text": "0"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    }
                                  ],
                                  "workbookContext": {
                                    "componentIdSource": "workbook",
                                    "resourceIdsSource": "workbook",
                                    "templateIdSource": "static",
                                    "templateId": "community-workbooks/UpdateCompliance/Quality Updates/resourceGroups/EdpTest2/providers/microsoft.insights/workbooks/408343bd-115b-4c7f-8e51-45d92e391c3b",
                                    "typeSource": "workbook",
                                    "gallerySource": "workbook",
                                    "locationSource": "default",
                                    "passSpecificParams": true,
                                    "templateParameters": [
                                      {
                                        "name": "_TargetBuild",
                                        "source": "column",
                                        "value": "TargetBuild"
                                      },
                                      {
                                        "name": "_TotalAlerts",
                                        "source": "column",
                                        "value": "Alerts"
                                      },
                                      {
                                        "name": "_OSVersion",
                                        "source": "column",
                                        "value": "TargetVersion"
                                      }
                                    ]
                                  }
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "DeploymentId",
                                "formatter": 18,
                                "formatOptions": {
                                  "thresholdsOptions": "icons",
                                  "thresholdsGrid": [
                                    {
                                      "operator": "is Empty",
                                      "representation": "Blank",
                                      "text": "N/A"
                                    },
                                    {
                                      "operator": "Default",
                                      "thresholdValue": null,
                                      "representation": "Blank",
                                      "text": "{0}{1}"
                                    }
                                  ]
                                }
                              },
                              {
                                "columnMatch": "KBNumberLink",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkColumn": "KBLinkText",
                                  "linkTarget": "Url"
                                }
                              },
                              {
                                "columnMatch": "KBLinkText",
                                "formatter": 5,
                                "formatOptions": {
                                  "linkTarget": "Url",
                                  "linkIsContextBlade": false
                                }
                              },
                              {
                                "columnMatch": "TotalDevices",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "WorkbookTemplate",
                                  "linkIsContextBlade": false,
                                  "workbookContext": {
                                    "componentIdSource": "workbook",
                                    "resourceIdsSource": "workbook",
                                    "templateIdSource": "static",
                                    "templateId": "community-workbooks/UpdateCompliance/Quality Updates/resourceGroups/EdpTest2/providers/microsoft.insights/workbooks/d931a806-fb13-41e3-86fa-dbd631340901",
                                    "typeSource": "workbook",
                                    "gallerySource": "workbook",
                                    "locationSource": "default",
                                    "passSpecificParams": true,
                                    "templateParameters": [
                                      {
                                        "name": "_TargetVersion",
                                        "source": "column",
                                        "value": "TargetVersion"
                                      },
                                      {
                                        "name": "_TargetBuild",
                                        "source": "column",
                                        "value": "TargetBuild"
                                      },
                                      {
                                        "name": "_DeviceCount",
                                        "source": "column",
                                        "value": "TotalDevices"
                                      },
                                      {
                                        "name": "_UpdateClassification",
                                        "source": "static",
                                        "value": "Security"
                                      },
                                      {
                                        "name": "_DeploymentId",
                                        "source": "column",
                                        "value": "DeploymentId"
                                      },
                                      {
                                        "name": "_ReleasedOn",
                                        "source": "column",
                                        "value": "UpdateReleaseTime"
                                      }
                                    ]
                                  },
                                  "bladeOpenContext": {
                                    "bladeName": "UsageNotebookBlade",
                                    "extensionName": "AppInsightsExtension",
                                    "bladeParameters": [
                                      {
                                        "name": "ComponentId",
                                        "source": "static",
                                        "value": "community-workbooks/UpdateCompliance/Quality Updates/resourcegroups/edptest2/providers/microsoft.operationalinsights/workspaces/oms-uc-test"
                                      },
                                      {
                                        "name": "ConfigurationId",
                                        "source": "static",
                                        "value": "community-workbooks/UpdateCompliance/Quality Updates/resourceGroups/EdpTest2/providers/microsoft.insights/workbooks/d931a806-fb13-41e3-86fa-dbd631340901"
                                      },
                                      {
                                        "name": "Type",
                                        "source": "static",
                                        "value": "workbook"
                                      },
                                      {
                                        "name": "WorkbookTemplateName",
                                        "source": "static",
                                        "value": "UC-QU-V2-DeviceList"
                                      },
                                      {
                                        "name": "_SelectedTargetVersion",
                                        "source": "column",
                                        "value": "TargetVersion"
                                      },
                                      {
                                        "name": "_SelectedTargetBuild",
                                        "source": "column",
                                        "value": "TargetBuild"
                                      }
                                    ]
                                  }
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              },
                              {
                                "columnMatch": "UpdateReleaseTime",
                                "formatter": 5
                              },
                              {
                                "columnMatch": "Devices",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkColumn": "TargetBuild",
                                  "linkTarget": "WorkbookTemplate",
                                  "linkIsContextBlade": true
                                },
                                "numberFormat": {
                                  "unit": 0,
                                  "options": {
                                    "style": "decimal",
                                    "useGrouping": true
                                  }
                                }
                              }
                            ],
                            "filter": true,
                            "sortBy": [
                              {
                                "itemKey": "TargetVersion",
                                "sortOrder": 2
                              }
                            ]
                          },
                          "sortBy": [
                            {
                              "itemKey": "TargetVersion",
                              "sortOrder": 2
                            }
                          ],
                          "graphSettings": {
                            "type": 0,
                            "topContent": {
                              "columnMatch": "TargetVersion",
                              "formatter": 1
                            },
                            "centerContent": {
                              "columnMatch": "Alerts",
                              "formatter": 1,
                              "numberFormat": {
                                "unit": 17,
                                "options": {
                                  "maximumSignificantDigits": 3,
                                  "maximumFractionDigits": 2
                                }
                              }
                            }
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "Alerts",
                            "sizeAggregation": "Sum",
                            "legendMetric": "Alerts",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "Alerts",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "UpdateDeploymentStatus",
                        "styleSettings": {
                          "margin": "-30px 0px 0px 0px"
                        }
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selTab",
                    "comparison": "isEqualTo",
                    "value": "UpdateStatus"
                  },
                  "name": "UpdateDeploymentStatus"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": " let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| join kind=innerunique UCClient on AzureADDeviceId\r\n| where TimeGenerated >= _SnapshotTime\r\n| where UpdateCategory==\"WindowsQualityUpdate\"\r\n| summarize arg_max(TimeGenerated, *) by AzureADDeviceId\r\n| summarize OSBuildNumber=count() by OSBuild\r\n",
                          "size": 3,
                          "title": "OS  build number",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "piechart",
                          "chartSettings": {
                            "yAxis": [
                              "OSBuildNumber"
                            ],
                            "createOtherGroup": 9,
                            "showMetrics": false,
                            "showLegend": true,
                            "seriesLabelSettings": [
                              {
                                "seriesName": "",
                                "label": "Unknown"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumFractionDigits": 1
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "DeviceBuildNumberChart"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory == \"WindowsQualityUpdate\"\r\n| summarize arg_max(TimeGenerated, *) by AzureADDeviceId\r\n| summarize count() by TargetVersion",
                          "size": 3,
                          "title": "Target version",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "piechart",
                          "chartSettings": {
                            "seriesLabelSettings": [
                              {
                                "seriesName": "",
                                "label": "Unknown"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumFractionDigits": 1
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "TargetOSVersionChart"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nUCClientUpdateStatus\r\n| where TimeGenerated == _SnapshotTime\r\n| where UpdateCategory==\"WindowsQualityUpdate\"\r\n| summarize arg_max(TimeGenerated, *) by AzureADDeviceId\r\n| summarize UpdateConnectivity=count() by UpdateConnectivityLevel\r\n",
                          "size": 3,
                          "title": "Update connectivity",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "piechart",
                          "chartSettings": {
                            "yAxis": [
                              "UpdateConnectivity"
                            ],
                            "seriesLabelSettings": [
                              {
                                "seriesName": "",
                                "label": "Unknown"
                              }
                            ],
                            "ySettings": {
                              "numberFormatSettings": {
                                "unit": 17,
                                "options": {
                                  "style": "decimal",
                                  "useGrouping": true,
                                  "maximumFractionDigits": 1
                                }
                              }
                            }
                          }
                        },
                        "customWidth": "33",
                        "name": "UpdateConnectivityChart"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let _SnapshotTime = datetime({_SnapshotTime});\r\nlet DeviceInfo = (UCClientUpdateStatus\r\n    | join kind=innerunique UCClient on AzureADDeviceId\r\n    | where TimeGenerated == _SnapshotTime\r\n    | project\r\n        AzureADDeviceId,\r\n        DeviceName,\r\n        OSVersion,\r\n        OSBuild,\r\n        TargetVersion,\r\n        TargetBuild,\r\n        ClientState,\r\n        ClientSubstate);\r\nlet UpdateAlerts = (UCUpdateAlert\r\n    | where TimeGenerated == _SnapshotTime\r\n    | summarize Alerts=count() by AzureADDeviceId);\r\nlet DeviceAlerts = (UCDeviceAlert\r\n    | where TimeGenerated == _SnapshotTime\r\n    | summarize Alerts=count() by AzureADDeviceId);\r\nlet Alerts = (UpdateAlerts\r\n| join DeviceAlerts on AzureADDeviceId\r\n| extend TotalAlerts = Alerts + Alerts1\r\n| summarize by AzureADDeviceId, TotalAlerts);\r\nAlerts\r\n| join (DeviceInfo) on AzureADDeviceId\r\n| extend Name =  iff(isempty(DeviceName), \"NONAME\", tostring(DeviceName))\r\n| project\r\n    Name,\r\n    AzureADDeviceId,\r\n    OSVersion,\r\n    OSBuild,\r\n    TargetVersion,\r\n    TargetBuild,\r\n    ClientState,\r\n    TotalAlerts\r\n| project-reorder\r\n    Name,\r\n    AzureADDeviceId,\r\n    OSVersion,\r\n    OSBuild,\r\n    TargetVersion,\r\n    TargetBuild,\r\n    ClientState,\r\n    TotalAlerts\r\n| take 250\r\n\r\n",
                          "size": 2,
                          "showAnalytics": true,
                          "title": "Device Compliance Status",
                          "showExportToExcel": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "gridSettings": {
                            "formatters": [
                              {
                                "columnMatch": "Name",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "WorkbookTemplate",
                                  "linkIsContextBlade": true,
                                  "workbookContext": {
                                    "componentIdSource": "workbook",
                                    "resourceIdsSource": "workbook",
                                    "templateIdSource": "static",
                                    "templateId": "community-workbooks/UpdateCompliance/Quality Updates/resourceGroups/EdpTest2/providers/microsoft.insights/workbooks/1c4eff39-fd51-4bcb-8ff5-ec5a1d788b3a",
                                    "typeSource": "workbook",
                                    "gallerySource": "workbook",
                                    "locationSource": "default",
                                    "passSpecificParams": true,
                                    "templateParameters": [
                                      {
                                        "name": "_AzureADDeviceId",
                                        "source": "column",
                                        "value": "AzureADDeviceId"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "Alerts",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "WorkbookTemplate",
                                  "linkIsContextBlade": true,
                                  "workbookContext": {
                                    "componentIdSource": "workbook",
                                    "resourceIdsSource": "workbook",
                                    "templateIdSource": "static",
                                    "templateId": "community-workbooks/UpdateCompliance/Quality Updates/resourceGroups/EdpTest2/providers/microsoft.insights/workbooks/98e2e602-ad7e-4bd6-adee-c9c62279baaf",
                                    "typeSource": "workbook",
                                    "gallerySource": "workbook",
                                    "locationSource": "default",
                                    "passSpecificParams": true,
                                    "templateParameters": [
                                      {
                                        "name": "_AzureADDeviceId",
                                        "source": "column",
                                        "value": "AzureADDeviceId"
                                      }
                                    ]
                                  }
                                }
                              },
                              {
                                "columnMatch": "DeviceName",
                                "formatter": 1,
                                "formatOptions": {
                                  "linkTarget": "WorkbookTemplate",
                                  "linkIsContextBlade": true,
                                  "workbookContext": {
                                    "componentIdSource": "workbook",
                                    "resourceIdsSource": "workbook",
                                    "templateIdSource": "static",
                                    "templateId": "community-workbooks/UpdateCompliance/Quality Updates/resourcegroups/edptest2/providers/microsoft.insights/workbooks/1c4eff39-fd51-4bcb-8ff5-ec5a1d788b3a",
                                    "typeSource": "workbook",
                                    "gallerySource": "workbook",
                                    "locationSource": "default",
                                    "passSpecificParams": true,
                                    "templateParameters": [
                                      {
                                        "name": "_AzureADDeviceId",
                                        "source": "column",
                                        "value": "AzureADDeviceId"
                                      }
                                    ]
                                  }
                                }
                              }
                            ],
                            "filter": true
                          }
                        },
                        "name": "DeviceComplianceStatus"
                      }
                    ]
                  },
                  "conditionalVisibility": {
                    "parameterName": "selTab",
                    "comparison": "isEqualTo",
                    "value": "DeviceStatus"
                  },
                  "name": "DeviceStatus"
                }
              ],
              "exportParameters": true
            },
            "conditionalVisibility": {
              "parameterName": "currentWorkbook",
              "comparison": "isEqualTo",
              "value": "QualityUpdates"
            },
            "name": "QualityUpdatesContentGroup"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibilities": [
        {
          "parameterName": "hasLogAnalyticsData",
          "comparison": "isEqualTo",
          "value": "true"
        },
        {
          "parameterName": "mappedSubscription",
          "comparison": "isNotEqualTo"
        },
        {
          "parameterName": "mappedWorkspace",
          "comparison": "isNotEqualTo"
        }
      ],
      "name": "HubGroup"
    }
  ],
  "fallbackResourceIds": [
    "community-workbooks/UpdateCompliance/Update Compliance Hub"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}